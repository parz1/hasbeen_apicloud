<!DOCTYPE html><html><head>    <meta charset="UTF-8">    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">    <title>发现</title>    <link rel="stylesheet" type="text/css" href="../css/api.css"/>    <link rel="stylesheet" type="text/css" href="../css/style.css"/>    <style>    *{      padding: 0;      margin: 0;    }    ul li{      list-style: none;    }    body{      background-color: #eee;    }    .leftWaterFall{      display: block;      width: 50%;      background-color: #eee;      padding: 0px;      float: left;      margin-left: 0;    }    .rightWaterFall{      display: block;      width: 50%;      background-color: #eee;      padding: 0px;      float: right;      margin-right: 0;    }    .dymc{      width: 100%;    }    .myLi{      margin-left: 5px;      background-color: #fff;      margin-top: 10px;      overflow: hidden;      border-radius: 5px;    }    </style></head><body>  <div class="dymc">    <ul class="leftWaterFall">    </ul>    <ul class="rightWaterFall">    </ul>  </div></body><script src="../script/data.js" charset="utf-8"></script><script type="text/javascript" src="../script/api.js"></script><script type="text/javascript">var datas = [];var images = [];var sh = window.innerHeight;apiready = function(){  var test = $api.dom('.leftWaterFall');  api.ajax({      url: myurl + 'getNotes.html',      method: 'post',      data: {      }  },function(ret, err){      if (ret) {          alert( JSON.stringify( ret ) );      } else {          alert( JSON.stringify( err ) );      }  });  init();  waterfall(datas);  waterfall(datas);  waterfall(datas);  waterfall(datas);  waterfall(datas);  images = $api.domAll('img');  window.onscroll = lazyloadFn;  //console.log(sh);  lazyloadFn();}function init(){  //测试样例  datas = [    {      "title":"港岛记1",      "position":"香港",      "content":"safjeiarjsifldiaruiejsfildjsairlejsilfjdilsajerisuali",      "scale":"1",      "src":"http://pci4eim1v.bkt.clouddn.com/QYER_1532571879602.jpg"    },    {      "title":"港岛记2",      "position":"香港",      "content":"safjeiarjsifldiaruiejsfildjsairlejsilfjdilsajerisuali",      "scale":"2",      "src":"http://pci4eim1v.bkt.clouddn.com/QYER_1532571902396.jpg"    },    {      "title":"港岛记3",      "position":"香港",      "content":"safjeiarjsifldiaruiejsfildjsairlejsilfjdilsajerisuali",      "scale":"1.5",      "src":"http://pci4eim1v.bkt.clouddn.com/QYER_1532571887524.jpg"    },    {      "title":"港岛记4",      "position":"香港",      "content":"safjeiarjsifldiaruiejsfildjsairlejsilfjdilsajerisuali",      "scale":"1.3",      "src":"http://pci4eim1v.bkt.clouddn.com/QYER_1532571900189.jpg"    },    {      "title":"港岛记5",      "position":"香港",      "content":"safjeiarjsifldiaruiejsfildjsairlejsilfjdilsajerisuali",      "scale":"0.5",      "src":"http://pci4eim1v.bkt.clouddn.com/QYER_1532571905598.jpg"    },  ];}function beALi(ele){  var el = document.createElement('li');  var len = $api.dom('.leftWaterFall').offsetWidth-10;  el.style.width=len+'px';  el.className = 'myLi';  //console.log(len);  el.innerHTML="<img class='cover' style='width:"+ len +"px;opacity:0;' src='../image/bgpic.png' data-src='"+ ele.src +"'/>"        + "<div class='navpos'>"+ ele.position +"</div>"        + "<div>"+ ele.title +"</div>"        + "<div>"+ ele.content +"</div>";  return el;}function waterfall(ele){  var leftul = $api.dom('.leftWaterFall');  var rightul = $api.dom('.rightWaterFall');  for(var i=0;i<ele.length;i++){    //console.log(leftul.offsetHeight +'*' +rightul.offsetHeight);    if(leftul.offsetHeight<rightul.offsetHeight){      leftul.appendChild(beALi(ele[i]));    }    else{      rightul.appendChild(beALi(ele[i]));    }  }}function lazyloadFn(){  //console.log('Lazy!');  var st = document.body.scrollTop;  var sn = sh + st;  for(var i = 0; i < images.length; i++){    if(images[i].offsetTop <= sn){      images[i].src = images[i].getAttribute("data-src");      images[i].style.transition = "opacity 4s";      images[i].style.opacity = "1";    }  }}</script></html>